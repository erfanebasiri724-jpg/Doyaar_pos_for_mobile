<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ú©Ø§ÙÙ‡ Ø¨Ø³ØªÙ†ÛŒ Ø¯ÙˆÛŒØ§Ø± ğŸ¦</title>
<style>
:root{
  --bg:#fff7fb;       /* Ø²Ù…ÛŒÙ†Ù‡ Ø±ÙˆØ´Ù† Ù¾Ø§Ø³ØªÙ„ÛŒ */
  --card:#fff0f5;     /* Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ */
  --accent:#ff7fb3;   /* ØµÙˆØ±ØªÛŒ Ø§ØµÙ„ÛŒ */
  --accent-2:#ffc6da;
  --muted:#6b6b6b;
  --text:#222;
  --success:#28a745;
}
/* Ù¾Ø§ÛŒÙ‡ */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:Tahoma, Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
}

/* Ù‡Ø¯Ø± */
header{
  padding:14px 12px;
  text-align:center;
  background:linear-gradient(90deg,var(--card),#ffeef6);
  border-bottom:1px solid rgba(255,128,170,0.12);
}
header h1{margin:0;font-size:1.2rem;font-weight:800;color:var(--accent);}

/* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ùˆ Ø¬Ø³ØªØ¬Ùˆ */
.container{padding:12px;padding-bottom:120px}
.search{margin:10px 0}
.search input{
  width:100%;padding:10px 12px;border-radius:10px;border:1px solid #ffdce6;background:#fff;color:var(--text);font-size:0.95rem;
}

/* Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ */
.controls{display:flex;gap:8px;margin-top:8px}
.btn{flex:1;padding:10px;border-radius:10px;border:none;background:var(--accent);color:#fff;font-weight:700;cursor:pointer}
.btn.ghost{background:transparent;border:1px solid rgba(255,128,170,0.2);color:var(--text)}

/* Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ† Ùˆ Ù…Ø­ØµÙˆÙ„Ø§Øª */
.accordion{margin-top:12px}
.acc-btn{
  width:100%;text-align:right;padding:12px;border-radius:10px;border:none;background:#fff;color:var(--accent-2);font-weight:700;
  display:flex;justify-content:space-between;align-items:center;cursor:pointer;font-size:0.95rem;margin-top:8px;
}
.acc-btn.active{background:linear-gradient(90deg,var(--accent-2),var(--accent));color:#fff}
.panel{background:var(--card);margin-top:8px;border-radius:8px;padding:6px;display:none}
.product{
  display:flex;justify-content:space-between;align-items:center;padding:10px;border-bottom:1px dashed rgba(0,0,0,0.04);gap:8px;
}
.prod-left{display:flex;flex-direction:column;align-items:flex-end;max-width:70%}
.prod-name{font-weight:700;font-size:0.97rem}
.prod-price{color:var(--muted);font-size:0.83rem;margin-top:4px}
.prod-add{
  padding:8px 12px;background:var(--accent);border:none;border-radius:8px;color:#fff;font-weight:800;cursor:pointer;min-width:72px;
  transition:transform .08s ease;
}
.prod-add:active{transform:scale(.97)}

/* Ø¯Ú©Ù…Ù‡ Ø³Ø¨Ø¯ Ùˆ Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡ (Ù‡Ù…ÛŒØ´Ù‡ Ø±ÙˆÛŒ Ù¾Ù†Ù„ Ø¨Ø§Ø´Ø¯) */
.cart-toggle{
  position:fixed;bottom:18px;left:18px;width:56px;height:56px;border-radius:50%;
  background:var(--accent);color:#fff;font-weight:800;font-size:20px;border:none;cursor:pointer;z-index:1400;
  display:flex;align-items:center;justify-content:center;
}
.cart-count{
  position:absolute;top:-7px;right:-7px;background:#ff2a6d;color:#fff;width:22px;height:22px;border-radius:50%;font-size:0.8rem;display:flex;align-items:center;justify-content:center;font-weight:800;
}

/* Ù¾Ù†Ù„ Ø³Ø¨Ø¯ Ø§Ø² Ø³Ù…Øª Ø±Ø§Ø³Øª */
.cart-panel{
  position:fixed;top:0;right:0;width:88%;max-width:420px;height:100%;background:linear-gradient(180deg,var(--card),#fff7fb);
  border-left:1px solid rgba(255,128,170,0.12);box-shadow:-12px 0 36px rgba(0,0,0,0.08);
  display:flex;flex-direction:column;padding:12px;transform:translateX(110%);transition:transform .28s ease;z-index:1300;
}
.cart-panel.open{transform:translateX(0)}
.cart-header{display:flex;justify-content:space-between;align-items:center;gap:8px;padding-bottom:6px}
.cart-list{flex:1;overflow:auto;margin-top:8px;padding-right:6px}
.cart-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-bottom:1px dashed rgba(0,0,0,0.04)}
.cart-item .name{font-weight:700;font-size:0.95rem}
.cart-item .price{font-size:0.85rem;color:var(--muted)}
.qty{display:flex;gap:6px;align-items:center}
.qty input{width:56px;padding:6px;border-radius:8px;border:1px solid #ffdce6;text-align:center;background:#fff;color:var(--text);font-size:0.9rem}
.remove-btn{padding:6px 10px;background:#ff7fb3;border:none;border-radius:6px;color:#fff;font-weight:700;cursor:pointer}
.total{display:flex;justify-content:space-between;align-items:center;margin-top:8px;font-weight:800;font-size:0.95rem}
.printBtn{width:100%;margin-top:10px;padding:10px;border-radius:8px;border:none;background:var(--accent);color:#fff;font-weight:800}

/* ÙÛŒØ¯Ø¨Ú© Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù† (Ø¨Ø§Ù„Ø§ÛŒ ØµÙØ­Ù‡ØŒ Ú©ÙˆÚ†Ú©) */
.added-feedback{
  position:fixed;top:10px;left:50%;transform:translateX(-50%);background:var(--success);color:#fff;padding:8px 12px;border-radius:8px;font-weight:700;
  font-size:0.9rem;display:none;z-index:1500;box-shadow:0 6px 18px rgba(0,0,0,0.12);
}

/* ÙØ§Ú©ØªÙˆØ± Ú†Ø§Ù¾: ÙˆÙ‚ØªÛŒ Ú†Ø§Ù¾ Ù…ÛŒØ´Ù‡ Ø¯Ø§Ø®Ù„ Ù¾Ù†Ø¬Ø±Ù‡â€ŒÛŒ Ø¬Ø¯ÛŒØ¯ Ø³ÙÛŒØ¯ Ù†Ù…Ø§ÛŒØ´ Ù…ÛŒØ¯Ù‡ÛŒÙ… */
/* Ø§Ø³ØªØ§ÛŒÙ„ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ø®ÙˆØ¯ ØµÙØ­Ù‡ Ù‡Ù… Ù‚Ø±Ø§Ø± Ø¯Ø§Ø¯ÛŒÙ… (Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø²) */
.invoice-preview{display:none}

/* ÙˆØ§Ú©Ù†Ø´â€ŒÙ¾Ø°ÛŒØ±ÛŒ */
@media(min-width:900px){
  .container{max-width:900px;margin:0 auto}
  .cart-panel{width:380px}
}
</style>
</head>
<body>

<header><h1>Ú©Ø§ÙÙ‡ Ø¨Ø³ØªÙ†ÛŒ Ø¯ÙˆÛŒØ§Ø± ğŸ¦</h1></header>

<div class="container">
  <div class="search"><input id="searchInput" placeholder="Ø¬Ø³Øªâ€ŒÙˆØ¬Ùˆ Ù…Ø­ØµÙˆÙ„..." /></div>
  <div class="controls"><button class="btn" id="clearCartBtn">Ø®Ø§Ù„ÛŒ Ú©Ø±Ø¯Ù† Ø³Ø¨Ø¯</button></div>

  <div id="listContainer"></div>
</div>

<!-- Ø¢ÛŒÚ©ÙˆÙ† Ø³Ø¨Ø¯ (Ù‡Ù…ÛŒØ´Ù‡ Ø¬Ù„Ùˆ Ù¾Ù†Ù„ Ø§Ø³Øª) -->
<button class="cart-toggle" id="cartToggle">ğŸ›’<div class="cart-count" id="cartCount">0</div></button>

<!-- Ù¾Ù†Ù„ Ø³Ø¨Ø¯ -->
<div class="cart-panel" id="cartPanel" aria-hidden="true">
  <div class="cart-header">
    <div><strong>Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</strong></div>
    <div style="display:flex;gap:8px;align-items:center">
      <div class="small" id="subtotalShow">Ø¬Ù…Ø¹: 0 ØªÙˆÙ…Ø§Ù†</div>
      <button id="closeCartBtn" style="background:none;border:none;color:var(--accent);font-size:18px;cursor:pointer">âœ–</button>
    </div>
  </div>

  <div class="cart-list" id="cartList"></div>

  <div class="total">
    <div class="small">Ù…Ø¨Ù„Øº Ù†Ù‡Ø§ÛŒÛŒ</div>
    <div id="totalPrice">0 ØªÙˆÙ…Ø§Ù†</div>
  </div>

  <button class="printBtn" id="printBtn">Ù†Ù…Ø§ÛŒØ´ Ùˆ Ú†Ø§Ù¾ ÙØ§Ú©ØªÙˆØ±</button>
</div>

<!-- ÙÛŒØ¯Ø¨Ú© Ø«Ø§Ø¨Øª Ø¨Ø§Ù„Ø§ÛŒ ØµÙØ­Ù‡ -->
<div id="addedFeedback" class="added-feedback">âœ… Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯</div>

<!-- Ù‚Ø§Ù„Ø¨ ÙØ§Ú©ØªÙˆØ± (Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø®Øª HTML Ú†Ø§Ù¾) -->
<div id="invoiceTemplate" class="invoice-preview" aria-hidden="true">
  <div style="text-align:center;margin-bottom:8px;">
    <div style="font-weight:800;font-size:1.1rem">Ú©Ø§ÙÙ‡ Ø¨Ø³ØªÙ†ÛŒ Ø¯ÙˆÛŒØ§Ø±</div>
    <div style="font-size:13px;margin-top:4px">Ø±Ø³ÛŒØ¯ ÙØ±ÙˆØ´</div>
  </div>
  <table id="invoiceTable" style="width:100%;border-collapse:collapse;">
    <thead>
      <tr>
        <th style="border-bottom:1px solid #ccc;text-align:right;padding:6px">Ù…Ø­ØµÙˆÙ„</th>
        <th style="border-bottom:1px solid #ccc;text-align:center;padding:6px">ØªØ¹Ø¯Ø§Ø¯</th>
        <th style="border-bottom:1px solid #ccc;text-align:center;padding:6px">ÙÛŒ</th>
        <th style="border-bottom:1px solid #ccc;text-align:center;padding:6px">Ø¬Ù…Ø¹</th>
      </tr>
    </thead>
    <tbody id="invoiceBody"></tbody>
  </table>
  <div style="margin-top:10px;text-align:right;font-weight:800">Ø¬Ù…Ø¹ Ú©Ù„: <span id="invoiceTotal">0</span> ØªÙˆÙ…Ø§Ù†</div>
  <div style="margin-top:6px;text-align:center;font-size:12px" id="invoiceDate"></div>
</div>

<script>
// ====== Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ (Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ùˆ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø·Ø¨Ù‚ Ù„ÛŒØ³Øª Ø´Ù…Ø§) ======
const products = [
  /* Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡ */
  {name:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ø¨Ø¯ÙˆÙ† Ù…ØºØ²", price:220000, cat:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡"},
  {name:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ù…ØºØ²Ø¯Ø§Ø±", price:260000, cat:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡"},
  {name:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ù„ÛŒÙˆØ§Ù†ÛŒ", price:40000, cat:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡"},
  {name:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ø­ØµÛŒØ±ÛŒ", price:40000, cat:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡"},
  {name:"Ø¨Ø³ØªÙ†ÛŒ Ø§Ø³Ú©ÙˆÙ¾ÛŒ", price:25000, cat:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡"},
  {name:"Ø¨Ø³ØªÙ†ÛŒ Ù‚ÛŒÙÛŒ ÙˆØ§Ù†ÛŒÙ„ÛŒ", price:35000, cat:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡"},
  {name:"Ø¨Ø³ØªÙ†ÛŒ Ù‚ÛŒÙÛŒ ÙˆØ§Ù†ÛŒÙ„ Ú©Ø§Ú©Ø§Ø¦Ùˆ", price:40000, cat:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡"},
  {name:"Ø¨Ø³ØªÙ†ÛŒ Ø¯Ø³ØªÚ¯Ø§Ù‡ÛŒ Ù„ÛŒÙˆØ§Ù† Ú©ÙˆÚ†Ú©", price:40000, cat:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡"},
  {name:"Ø¨Ø³ØªÙ†ÛŒ Ø¯Ø³ØªÚ¯Ø§Ù‡ÛŒ Ù„ÛŒÙˆØ§Ù† Ø¨Ø²Ø±Ú¯", price:50000, cat:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡"},
  {name:"ÙØ§Ù„ÙˆØ¯Ù‡", price:50000, cat:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡"},
  {name:"ÙØ§Ù„ÙˆØ¯Ù‡ Ø¨Ø³ØªÙ†ÛŒ", price:70000, cat:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡"},
  {name:"Ø·Ø§Ù„Ø¨ÛŒ Ø¨Ø³ØªÙ†ÛŒ", price:70000, cat:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡"},
  {name:"Ø¢Ø¨ Ù‡ÙˆÛŒØ¬ Ø¨Ø³ØªÙ†ÛŒ", price:60000, cat:"Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡"},

  /* Ø¢Ø¨Ù…ÛŒÙˆÙ‡â€ŒÙ‡Ø§ */
  {name:"Ø¢Ø¨ Ù‡ÙˆÛŒØ¬", price:40000, cat:"Ø¢Ø¨Ù…ÛŒÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ø¢Ø¨ Ø§Ù†Ø§Ø±", price:90000, cat:"Ø¢Ø¨Ù…ÛŒÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ø¢Ø¨ Ø²Ø±Ø´Ú©", price:90000, cat:"Ø¢Ø¨Ù…ÛŒÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ø¢Ø¨ Ø³ÛŒØ¨", price:70000, cat:"Ø¢Ø¨Ù…ÛŒÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ø¢Ø¨ Ø·Ø§Ù„Ø¨ÛŒ", price:60000, cat:"Ø¢Ø¨Ù…ÛŒÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ø¢Ø¨ Ù‡Ù†Ø¯ÙˆØ§Ù†Ù‡", price:60000, cat:"Ø¢Ø¨Ù…ÛŒÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ø¢Ø¨ Ø¢Ù„Ø¨Ø§Ù„Ùˆ", price:60000, cat:"Ø¢Ø¨Ù…ÛŒÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ø¢Ø¨ Ù¾Ø±ØªÙ‚Ø§Ù„", price:80000, cat:"Ø¢Ø¨Ù…ÛŒÙˆÙ‡â€ŒÙ‡Ø§"},

  /* Ø´ÛŒØ±Ù‡Ø§ Ùˆ Ø´ÛŒÚ©â€ŒÙ‡Ø§ */
  {name:"Ø´ÛŒØ± Ù…ÙˆØ²", price:80000, cat:"Ø´ÛŒØ±Ù‡Ø§ Ùˆ Ø´ÛŒÚ©â€ŒÙ‡Ø§"},
  {name:"Ø´ÛŒØ± Ù…ÙˆØ² Ø®Ø±Ù…Ø§", price:120000, cat:"Ø´ÛŒØ±Ù‡Ø§ Ùˆ Ø´ÛŒÚ©â€ŒÙ‡Ø§"},
  {name:"Ø´ÛŒØ± Ù…ÙˆØ² Ú¯Ø±Ø¯Ùˆ", price:150000, cat:"Ø´ÛŒØ±Ù‡Ø§ Ùˆ Ø´ÛŒÚ©â€ŒÙ‡Ø§"},
  {name:"Ø´ÛŒØ± Ù¾Ø³ØªÙ‡", price:150000, cat:"Ø´ÛŒØ±Ù‡Ø§ Ùˆ Ø´ÛŒÚ©â€ŒÙ‡Ø§"},
  {name:"Ø´ÛŒØ± Ø§Ù†Ø¨Ù‡", price:180000, cat:"Ø´ÛŒØ±Ù‡Ø§ Ùˆ Ø´ÛŒÚ©â€ŒÙ‡Ø§"},
  {name:"Ø´ÛŒØ± Ù…ÙˆØ² Ø¨Ø³ØªÙ†ÛŒ", price:100000, cat:"Ø´ÛŒØ±Ù‡Ø§ Ùˆ Ø´ÛŒÚ©â€ŒÙ‡Ø§"},
  {name:"Ø´ÛŒÚ©", price:120000, cat:"Ø´ÛŒØ±Ù‡Ø§ Ùˆ Ø´ÛŒÚ©â€ŒÙ‡Ø§"},
  {name:"Ø¢ÛŒØ³ Ù¾Ú©", price:120000, cat:"Ø´ÛŒØ±Ù‡Ø§ Ùˆ Ø´ÛŒÚ©â€ŒÙ‡Ø§"},

  /* Ù…Ø¹Ø¬ÙˆÙ† Ùˆ Ú©ÛŒÚ© Ø¨Ø³ØªÙ†ÛŒ */
  {name:"Ù…Ø¹Ø¬ÙˆÙ† Ù„ÛŒÙˆØ§Ù†ÛŒ", price:160000, cat:"Ù…Ø¹Ø¬ÙˆÙ† Ùˆ Ú©ÛŒÚ© Ø¨Ø³ØªÙ†ÛŒ"},
  {name:"Ù…Ø¹Ø¬ÙˆÙ† Ú©Ø§Ø³Ù‡â€ŒØ§ÛŒ Ú©ÙˆÚ†Ú©", price:180000, cat:"Ù…Ø¹Ø¬ÙˆÙ† Ùˆ Ú©ÛŒÚ© Ø¨Ø³ØªÙ†ÛŒ"},
  {name:"Ù…Ø¹Ø¬ÙˆÙ† Ú©Ø§Ø³Ù‡â€ŒØ§ÛŒ Ø¨Ø²Ø±Ú¯", price:250000, cat:"Ù…Ø¹Ø¬ÙˆÙ† Ùˆ Ú©ÛŒÚ© Ø¨Ø³ØªÙ†ÛŒ"},
  {name:"Ú©ÛŒÚ© Ø¨Ø³ØªÙ†ÛŒ Ù„ÛŒÙˆØ§Ù†ÛŒ", price:70000, cat:"Ù…Ø¹Ø¬ÙˆÙ† Ùˆ Ú©ÛŒÚ© Ø¨Ø³ØªÙ†ÛŒ"},
  {name:"Ú©ÛŒÚ© Ø¨Ø³ØªÙ†ÛŒ Ù…Ø®ØµÙˆØµ", price:150000, cat:"Ù…Ø¹Ø¬ÙˆÙ† Ùˆ Ú©ÛŒÚ© Ø¨Ø³ØªÙ†ÛŒ"},

  /* Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§ */
  {name:"Ø³ÛŒÙ†Ú¯Ù„", price:40000, cat:"Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ø¯Ø¨Ù„", price:50000, cat:"Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ø¢ÙÙˆÚ¯Ø§ØªÙˆ", price:80000, cat:"Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ù‡Ø§Øª Ú†Ø§Ú©Ù„Øª", price:90000, cat:"Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ú©Ø§Ù¾ÙˆÚ†ÛŒÙ†Ùˆ", price:80000, cat:"Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ù…Ø§Ø³Ø§Ù„Ø§", price:80000, cat:"Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ù†Ø³Ú©Ø§ÙÙ‡", price:75000, cat:"Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ù„Ø§ØªÙ‡", price:85000, cat:"Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ø¢ÛŒØ³ Ù„Ø§ØªÙ‡", price:90000, cat:"Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ø§Ù…Ø±ÛŒÚ©Ø§Ù†Ùˆ", price:70000, cat:"Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ø¢ÛŒØ³ Ø§Ù…Ø±ÛŒÚ©Ø§Ù†Ùˆ", price:80000, cat:"Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ú©Ø§Ø±Ø§Ù…Ù„ Ù…Ø§Ú©ÛŒØ§ØªÙˆ", price:90000, cat:"Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"},
  {name:"Ù…ÙˆÚ©Ø§", price:90000, cat:"Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"},
];

// ====== Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ ======
const listContainer = document.getElementById('listContainer');
const searchInput = document.getElementById('searchInput');
const cartToggle = document.getElementById('cartToggle');
const cartPanel = document.getElementById('cartPanel');
const cartList = document.getElementById('cartList');
const cartCount = document.getElementById('cartCount');
const subtotalShow = document.getElementById('subtotalShow');
const totalPriceEl = document.getElementById('totalPrice');
const addedFeedback = document.getElementById('addedFeedback');
const printBtn = document.getElementById('printBtn');
const invoiceTemplate = document.getElementById('invoiceTemplate');
const invoiceBody = document.getElementById('invoiceBody');
const invoiceTotal = document.getElementById('invoiceTotal');
const invoiceDate = document.getElementById('invoiceDate');
const clearCartBtn = document.getElementById('clearCartBtn');
const closeCartBtn = document.getElementById('closeCartBtn');

let cart = [];

// ====== Ø³Ø§Ø®Øª Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ† Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§ Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ø¨Ù‡ ØªØ±ØªÛŒØ¨ Ø®ÙˆØ§Ø³ØªÙ‡â€ŒØ´Ø¯Ù‡ ======
const cats = ["Ø¨Ø³ØªÙ†ÛŒ Ø³Ù†ØªÛŒ Ùˆ ÙØ§Ù„ÙˆØ¯Ù‡","Ø¢Ø¨Ù…ÛŒÙˆÙ‡â€ŒÙ‡Ø§","Ø´ÛŒØ±Ù‡Ø§ Ùˆ Ø´ÛŒÚ©â€ŒÙ‡Ø§","Ù…Ø¹Ø¬ÙˆÙ† Ùˆ Ú©ÛŒÚ© Ø¨Ø³ØªÙ†ÛŒ","Ù‚Ù‡ÙˆÙ‡â€ŒÙ‡Ø§"];
cats.forEach(cat=>{
  const btn = document.createElement('button');
  btn.className = 'acc-btn';
  btn.innerHTML = `${cat} <span>â–¼</span>`;
  const panel = document.createElement('div');
  panel.className = 'panel';

  products.filter(p=>p.cat===cat).forEach(p=>{
    const prod = document.createElement('div');
    prod.className = 'product';
    prod.innerHTML = `<div class="prod-left"><div class="prod-name">${p.name}</div><div class="prod-price">${p.price.toLocaleString()} ØªÙˆÙ…Ø§Ù†</div></div><button class="prod-add">Ø§Ø¶Ø§ÙÙ‡</button>`;
    panel.appendChild(prod);
  });

  btn.addEventListener('click', ()=>{
    const isOpen = panel.style.display === 'block';
    panel.style.display = isOpen ? 'none' : 'block';
    btn.classList.toggle('active', !isOpen);
  });

  listContainer.appendChild(btn);
  listContainer.appendChild(panel);
});

// ====== Ø±ÙØªØ§Ø± Ø³Ø¨Ø¯ ======
cartToggle.addEventListener('click', ()=> {
  cartPanel.classList.toggle('open');
  cartPanel.setAttribute('aria-hidden', cartPanel.classList.contains('open') ? 'false' : 'true');
});
// close button
closeCartBtn.addEventListener('click', ()=> { cartPanel.classList.remove('open'); cartPanel.setAttribute('aria-hidden','true'); });

// ====== Ø§ÙÚ©Øª Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù† (Ø¨Ø§Ù„Ø§ÛŒ ØµÙØ­Ù‡) ======
let fbTimer = null;
function showFeedback(){
  if(fbTimer) clearTimeout(fbTimer);
  addedFeedback.style.display = 'block';
  fbTimer = setTimeout(()=> { addedFeedback.style.display = 'none'; fbTimer = null; }, 700);
}

// ====== Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯ (Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¯Ù„ÛŒÚ¯ÛŒØ´Ù†) ======
listContainer.addEventListener('click', (e)=>{
  if(!e.target.classList.contains('prod-add')) return;
  const prodEl = e.target.closest('.product');
  const name = prodEl.querySelector('.prod-name').textContent;
  const priceText = prodEl.querySelector('.prod-price').textContent.replace(/[^0-9]/g,'');
  const price = parseInt(priceText,10) || 0;

  const idx = cart.findIndex(c=>c.name===name);
  if(idx>-1) cart[idx].qty += 1;
  else cart.push({name, price, qty:1});
  renderCart();
  // ØªÛŒÚ© Ù…Ø­Ù„ÛŒ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ (Ø³Ø±ÛŒØ¹) + ÙÛŒØ¯Ø¨Ú© Ø¨Ø§Ù„Ø§ÛŒ ØµÙØ­Ù‡
  const btn = e.target;
  const prev = btn.textContent;
  btn.textContent = 'âœ… Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯';
  btn.disabled = true;
  setTimeout(()=>{ btn.textContent = prev; btn.disabled = false; }, 700);
  showFeedback();
});

// ====== Ø±Ù†Ø¯Ø± Ø³Ø¨Ø¯ ======
function renderCart(){
  cartList.innerHTML = '';
  let subtotal = 0;
  cart.forEach((item, idx)=>{
    const row = document.createElement('div');
    row.className = 'cart-item';
    row.innerHTML = `
      <div style="flex:1;min-width:0">
        <div class="name">${item.name}</div>
      </div>
      <div class="qty" style="display:flex;align-items:center;gap:8px;margin-left:8px">
        <input type="number" min="1" value="${item.qty}" data-index="${idx}" style="width:60px;padding:6px;border-radius:6px;border:1px solid #ffdce6;text-align:center;background:#fff;color:var(--text)">
        <button class="remove-btn" data-index="${idx}">âˆ’</button>
      </div>
      <div class="price" style="min-width:90px;text-align:left">${(item.price*item.qty).toLocaleString()} ØªÙˆÙ…Ø§Ù†</div>
    `;
    cartList.appendChild(row);
    subtotal += item.price * item.qty;
  });
  cartCount.textContent = cart.reduce((s,i)=>s+i.qty,0);
  subtotalShow.textContent = 'Ø¬Ù…Ø¹: ' + subtotal.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
  totalPriceEl.textContent = subtotal.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
}

// ØªØºÛŒÛŒØ± Ù…Ù‚Ø¯Ø§Ø± Ø¨Ø§ Ø§ÛŒÙ†Ù¾ÙˆØª ÛŒØ§ Ø­Ø°Ù Ø¯ÙˆÙ†Ù‡â€ŒØ¯ÙˆÙ†Ù‡
cartList.addEventListener('input', (e)=>{
  if(e.target.tagName !== 'INPUT') return;
  const idx = parseInt(e.target.dataset.index,10);
  cart[idx].qty = Math.max(1, parseInt(e.target.value)||1);
  renderCart();
});
cartList.addEventListener('click', (e)=>{
  if(!e.target.classList.contains('remove-btn')) return;
  const idx = parseInt(e.target.dataset.index,10);
  if(cart[idx].qty > 1) cart[idx].qty -= 1;
  else cart.splice(idx,1);
  renderCart();
});

// Ø®Ø§Ù„ÛŒ Ú©Ø±Ø¯Ù† Ø³Ø¨Ø¯
clearCartBtn.addEventListener('click', ()=> { cart = []; renderCart(); });

// ====== Ø¬Ø³ØªØ¬Ùˆ ======
searchInput.addEventListener('input', (e)=>{
  const q = e.target.value.trim();
  document.querySelectorAll('.panel').forEach(panel=>{
    panel.querySelectorAll('.product').forEach(prod=>{
      const name = prod.querySelector('.prod-name').textContent;
      prod.style.display = name.includes(q) ? 'flex' : 'none';
    });
  });
});

// ====== Ú†Ø§Ù¾ ÙØ§Ú©ØªÙˆØ± Ø³ÙÛŒØ¯ Ùˆ Ù…Ø±ØªØ¨ Ø¯Ø± Ù¾Ù†Ø¬Ø±Ù‡ Ø¬Ø¯ÛŒØ¯ ======
printBtn.addEventListener('click', ()=>{
  // Ø³Ø§Ø®Øª tbody Ø¨Ø±Ø§ÛŒ ÙØ§Ú©ØªÙˆØ±
  let total = 0;
  let rows = '';
  cart.forEach(it=>{
    rows += `<tr>
      <td style="text-align:right;padding:6px;border-bottom:1px solid #ddd">${it.name}</td>
      <td style="text-align:center;padding:6px;border-bottom:1px solid #ddd">${it.qty}</td>
      <td style="text-align:center;padding:6px;border-bottom:1px solid #ddd">${it.price.toLocaleString()}</td>
      <td style="text-align:center;padding:6px;border-bottom:1px solid #ddd">${(it.price*it.qty).toLocaleString()}</td>
    </tr>`;
    total += it.price * it.qty;
  });

  const html = `<!doctype html>
  <html lang="fa" dir="rtl">
  <head>
    <meta charset="utf-8">
    <title>Ø±Ø³ÛŒØ¯ - Ú©Ø§ÙÙ‡ Ø¨Ø³ØªÙ†ÛŒ Ø¯ÙˆÛŒØ§Ø±</title>
    <style>
      body{font-family:Tahoma, Arial, sans-serif; margin:12px; color:#000; background:#fff;}
      h2{ text-align:center; margin-bottom:8px; }
      table{ width:100%; border-collapse:collapse; margin-top:8px; }
      th,td{ border:1px solid #ccc; padding:6px; font-size:13px; }
      th{ background:#f6f6f6; font-weight:800; }
      .total{margin-top:10px;font-weight:800;text-align:right}
      .footer{margin-top:8px;text-align:center;font-size:12px;color:#333}
    </style>
  </head>
  <body>
    <h2>Ú©Ø§ÙÙ‡ Ø¨Ø³ØªÙ†ÛŒ Ø¯ÙˆÛŒØ§Ø±</h2>
    <div style="text-align:center;margin-bottom:6px">Ø±Ø³ÛŒØ¯ ÙØ±ÙˆØ´</div>
    <table>
      <thead>
        <tr><th style="text-align:right">Ù…Ø­ØµÙˆÙ„</th><th>ØªØ¹Ø¯Ø§Ø¯</th><th>ÙÛŒ (ØªÙˆÙ…Ø§Ù†)</th><th>Ø¬Ù…Ø¹ (ØªÙˆÙ…Ø§Ù†)</th></tr>
      </thead>
      <tbody>
        ${rows || '<tr><td colspan="4" style="text-align:center;padding:10px">Ù‡ÛŒÚ† Ù…Ø­ØµÙˆÙ„ÛŒ Ø¯Ø± Ø³Ø¨Ø¯ Ù†ÛŒØ³Øª</td></tr>'}
      </tbody>
    </table>
    <div class="total">Ø¬Ù…Ø¹ Ú©Ù„: ${total.toLocaleString()} ØªÙˆÙ…Ø§Ù†</div>
    <div class="footer">ØªØ§Ø±ÛŒØ®: ${new Date().toLocaleString()}</div>
  </body>
  </html>`;

  const w = window.open('','_blank','width=420,height=700');
  if(!w){ alert('Ù…Ø±ÙˆØ±Ú¯Ø± Ø§Ø¬Ø§Ø²Ù‡Ù” Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù¾Ù†Ø¬Ø±Ù‡Ù” Ø¬Ø¯ÛŒØ¯ Ø±Ø§ Ù†Ø¯Ø§Ø¯ â€” popup blocker Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†'); return; }
  w.document.write(html);
  w.document.close();
  w.focus();
  w.print();
  // w.close(); // Ø¨Ø¹Ø¶ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø±Ù‡Ø§ Ù¾Ù†Ø¬Ø±Ù‡ Ø±Ø§ Ù…ÛŒâ€ŒØ¨Ù†Ø¯Ù†Ø¯Ø› Ø§Ú¯Ø± Ù…ÛŒâ€ŒØ®ÙˆØ§ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø¨Ù†Ø¯Ù‡ØŒ uncomment Ú©Ù†
});

// Ø´Ø±ÙˆØ¹ Ø§ÙˆÙ„ÛŒÙ‡
renderCart();
</script>
</body>
</html>
